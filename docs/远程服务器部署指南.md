# è¿œç¨‹æœåŠ¡å™¨éƒ¨ç½²æŒ‡å— ğŸš€

## æœåŠ¡å™¨é…ç½®

### SSH è¿æ¥ä¿¡æ¯
```bash
# è·³æ¿æœº
Host jump-server-tx
    HostName 134.175.121.223
    User zhukefei

# ç›®æ ‡æœåŠ¡å™¨ (é€šè¿‡è·³æ¿æœº)
Host pro-20
    HostName 172.16.0.27
    User zhukefei
    ProxyJump jump-server-tx
```

### å¿«é€Ÿè¿æ¥
```bash
# é€šè¿‡è·³æ¿æœºè¿æ¥åˆ°ç›®æ ‡æœåŠ¡å™¨
ssh -J zhukefei@134.175.121.223 zhukefei@172.16.0.27
```

---

## éƒ¨ç½²æ­¥éª¤

### 1. æœ¬åœ°ä»£ç æ›´æ–°åˆ°GitHub

```bash
cd /home/ubuntu/RoboticsDiffusionTransformer

# æ·»åŠ æ‰€æœ‰ä¿®æ”¹
git add -A

# æäº¤æ›´æ”¹
git commit -m "æ›´æ–°æè¿°"

# æ¨é€åˆ°GitHub
git push my-repo main
```

### 2. è¿œç¨‹æœåŠ¡å™¨æ‹‰å–ä»£ç 

```bash
# è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨
ssh -J zhukefei@134.175.121.223 zhukefei@172.16.0.27

# è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/RoboticsDiffusionTransformer

# æ‹‰å–æœ€æ–°ä»£ç 
git pull

# å¦‚æœæœ‰æœ¬åœ°ä¿®æ”¹éœ€è¦ä¿å­˜
git stash
git pull
git stash pop
```

### 3. ç¯å¢ƒé…ç½®æ£€æŸ¥

åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```bash
# æ¿€æ´»condaç¯å¢ƒ
conda activate rdt

# æ£€æŸ¥GPU
nvidia-smi

# æ£€æŸ¥Pythonç¯å¢ƒ
python -c "import torch; print(f'PyTorch: {torch.__version__}'); print(f'CUDA available: {torch.cuda.is_available()}'); print(f'GPU count: {torch.cuda.device_count()}')"
```

---

## æ•°æ®é›†é…ç½®

### è¿œç¨‹æœåŠ¡å™¨æ•°æ®é›†è·¯å¾„
```
/home/zhukefei/RoboticsDiffusionTransformer/data/datasets/libero_single_task/
```

### è®­ç»ƒè„šæœ¬è‡ªåŠ¨æ£€æµ‹
è®­ç»ƒè„šæœ¬å·²ä¿®æ”¹ä¸ºè‡ªåŠ¨æ£€æµ‹æ•°æ®é›†è·¯å¾„ï¼š

```bash
# ä¼˜å…ˆçº§1: data/datasets/libero_single_taskï¼ˆè¿œç¨‹æœåŠ¡å™¨ï¼‰
# ä¼˜å…ˆçº§2: datasets/libero_single_taskï¼ˆæœ¬åœ°ï¼‰
```

**æ— éœ€æ‰‹åŠ¨ä¿®æ”¹è·¯å¾„ï¼** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹ã€‚

---

## ä»£ç ä¿®å¤æ€»ç»“

### âœ… å·²ä¿®å¤çš„ç»å¯¹è·¯å¾„é—®é¢˜

#### 1. **è®­ç»ƒæ•°æ®åŠ è½½** (`data/hdf5_libero_dataset.py`)
```python
# ä¿®æ”¹å‰ï¼šç¡¬ç¼–ç ç›¸å¯¹è·¯å¾„
with open('configs/base.yaml', 'r') as file:
    config = yaml.safe_load(file)

# ä¿®æ”¹åï¼šä½¿ç”¨ç›¸å¯¹äºæ–‡ä»¶çš„è·¯å¾„
config_path = os.path.join(os.path.dirname(__file__), '..', 'configs', 'base.yaml')
with open(config_path, 'r') as file:
    config = yaml.safe_load(file)
```

#### 2. **è¯„ä¼°è„šæœ¬** (`eval_sim/eval_rdt_libero.py`)
```python
# è‡ªåŠ¨æ£€æµ‹LIBEROè·¯å¾„
libero_path = os.environ.get("LIBERO_PATH")

if not libero_path:
    # å°è¯•å‡ ä¸ªå¯èƒ½çš„è·¯å¾„
    possible_paths = [
        "../LIBERO/libero/libero",  # ä¸é¡¹ç›®åŒçº§
        "../../LIBERO/libero/libero",  # ä¸Šä¸¤çº§
        os.path.expanduser("~/LIBERO/libero/libero"),  # ç”¨æˆ·ç›®å½•
    ]
    for path in possible_paths:
        if os.path.exists(path):
            libero_path = path
            break
```

#### 3. **è®­ç»ƒè„šæœ¬** (`train_single_task.sh`, `train_single_task_2gpu.sh`)
```bash
# è‡ªåŠ¨æ£€æµ‹æ•°æ®é›†è·¯å¾„
if [ -d "./data/datasets/libero_single_task" ]; then
    export LIBERO_DATASET_DIR="./data/datasets/libero_single_task"
elif [ -d "./datasets/libero_single_task" ]; then
    export LIBERO_DATASET_DIR="./datasets/libero_single_task"
else
    echo "âŒ é”™è¯¯ï¼šæœªæ‰¾åˆ°å•ä»»åŠ¡æ•°æ®é›†ï¼"
    exit 1
fi
```

---

## è®­ç»ƒé…ç½®

### 8-GPU è®­ç»ƒ (è¿œç¨‹æœåŠ¡å™¨)

ä½¿ç”¨ `train_single_task_2gpu.sh` è„šæœ¬ï¼ˆå·²é…ç½®ä¸º8GPUï¼‰ï¼š

```bash
# ç¡®ä¿æ•°æ®é›†åœ¨æ­£ç¡®ä½ç½®
ls -lh /home/zhukefei/RoboticsDiffusionTransformer/data/datasets/libero_single_task/

# è¿è¡Œè®­ç»ƒ
bash train_single_task_2gpu.sh
```

### è®­ç»ƒé…ç½®å‚æ•°
```bash
# GPUé…ç½®
export CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7

# è®­ç»ƒå‚æ•°
--num_processes 8
--train_batch_size=4          # æ¯GPU batch size
--sample_batch_size=8
--max_train_steps=30000
--checkpointing_period=2000

# æ€»batch size = 4 * 8 = 32
```

### é¢„è®­ç»ƒæ¨¡å‹
```bash
# è¿œç¨‹æœåŠ¡å™¨è·¯å¾„
/home/zhukefei/RoboticsDiffusionTransformer/checkpoints/rdt-1b/model.safetensors
```

---

## è®­ç»ƒå‰æ£€æŸ¥æ¸…å•

### âœ… å¿…æ£€é¡¹ç›®

1. **GPUçŠ¶æ€**
   ```bash
   nvidia-smi
   # ç¡®è®¤8å¼ GPUéƒ½å¯ç”¨
   ```

2. **æ•°æ®é›†å­˜åœ¨**
   ```bash
   ls -lh data/datasets/libero_single_task/*.hdf5
   # åº”è¯¥çœ‹åˆ°æ•°æ®é›†æ–‡ä»¶
   ```

3. **ç»Ÿè®¡æ–‡ä»¶æ­£ç¡®**
   ```bash
   cat configs/dataset_stat.json | grep libero_single_task
   # åº”è¯¥çœ‹åˆ° libero_single_task çš„ç»Ÿè®¡ä¿¡æ¯
   ```

4. **è®­ç»ƒè„šæœ¬å¯æ‰§è¡Œ**
   ```bash
   ls -l train_single_task_2gpu.sh
   # åº”è¯¥æœ‰æ‰§è¡Œæƒé™ (-rwxr-xr-x)
   ```

5. **é¢„è®­ç»ƒæ¨¡å‹å­˜åœ¨**
   ```bash
   ls -lh checkpoints/rdt-1b/model.safetensors
   # åº”è¯¥æ˜¾ç¤ºæ¨¡å‹æ–‡ä»¶å¤§å°
   ```

---

## å¸¸è§é—®é¢˜æ’æŸ¥

### Q1: æ‰¾ä¸åˆ°æ•°æ®é›†
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
echo $LIBERO_DATASET_DIR

# æ£€æŸ¥ç›®å½•
ls -lR data/datasets/
```

### Q2: GPUä¸å¯ç”¨
```bash
# æ£€æŸ¥CUDA
nvidia-smi
nvcc --version

# æ£€æŸ¥PyTorch
python -c "import torch; print(torch.cuda.is_available())"
```

### Q3: å¯¼å…¥é”™è¯¯
```bash
# ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•
pwd  # åº”è¯¥æ˜¾ç¤º /home/zhukefei/RoboticsDiffusionTransformer

# ç¡®ä¿condaç¯å¢ƒæ¿€æ´»
conda info --envs
```

### Q4: æƒé™é—®é¢˜
```bash
# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x train_single_task_2gpu.sh
```

---

## ç›‘æ§è®­ç»ƒ

### å®æ—¶ç›‘æ§
```bash
# æŸ¥çœ‹GPUä½¿ç”¨æƒ…å†µ
watch -n 1 nvidia-smi

# æŸ¥çœ‹è®­ç»ƒæ—¥å¿—
tail -f nohup.out  # å¦‚æœä½¿ç”¨nohupè¿è¡Œ
```

### æ£€æŸ¥checkpoint
```bash
# æŸ¥çœ‹å·²ä¿å­˜çš„checkpoint
ls -lh checkpoints/single_task_scene7/
```

### Weights & Biases (å¦‚æœé…ç½®)
è®¿é—®: https://wandb.ai/your-project

---

## éƒ¨ç½²å®ŒæˆéªŒè¯

### 1. è¿æ¥æµ‹è¯•
```bash
ssh -J zhukefei@134.175.121.223 zhukefei@172.16.0.27 "echo 'âœ… SSHè¿æ¥æˆåŠŸ'"
```

### 2. ä»£ç æ›´æ–°æµ‹è¯•
```bash
ssh -J zhukefei@134.175.121.223 zhukefei@172.16.0.27 "cd ~/RoboticsDiffusionTransformer && git log --oneline -3"
```

### 3. ç¯å¢ƒæµ‹è¯•
```bash
ssh -J zhukefei@134.175.121.223 zhukefei@172.16.0.27 "cd ~/RoboticsDiffusionTransformer && conda activate rdt && python -c 'import torch; print(torch.cuda.device_count())'"
```

---

## å·²å®Œæˆçš„ä¿®å¤

### âœ… 2024-10-19 éƒ¨ç½²

1. **ä¿®å¤ç»å¯¹è·¯å¾„é—®é¢˜**
   - è®­ç»ƒä»£ç : ä½¿ç”¨ç›¸å¯¹è·¯å¾„åŠ è½½é…ç½®
   - è¯„ä¼°ä»£ç : LIBEROè·¯å¾„è‡ªåŠ¨æ£€æµ‹
   - è®­ç»ƒè„šæœ¬: æ•°æ®é›†è·¯å¾„è‡ªåŠ¨æ£€æµ‹

2. **æ›´æ–°ä»£ç åˆ°GitHub**
   - æäº¤: `fc33c02` - ä¿®å¤ç»å¯¹è·¯å¾„é—®é¢˜
   - æäº¤: `442374d` - æ·»åŠ å®Œæ•´ä»£ç å’Œæ–‡æ¡£

3. **è¿œç¨‹æœåŠ¡å™¨ä»£ç æ›´æ–°**
   - âœ… ä»£ç å·²pullåˆ°æœ€æ–°ç‰ˆæœ¬
   - âœ… å†²çªå·²è§£å†³
   - âœ… è®­ç»ƒè„šæœ¬å·²å°±ç»ª

---

## ä¸‹ä¸€æ­¥

### å¼€å§‹è®­ç»ƒ
```bash
# 1. è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨
ssh -J zhukefei@134.175.121.223 zhukefei@172.16.0.27

# 2. è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/RoboticsDiffusionTransformer

# 3. æ¿€æ´»ç¯å¢ƒ
conda activate rdt

# 4. è¿è¡Œè®­ç»ƒï¼ˆå‰å°ï¼‰
bash train_single_task_2gpu.sh

# æˆ–è€…åå°è¿è¡Œ
nohup bash train_single_task_2gpu.sh > train.log 2>&1 &

# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep accelerate
```

### ç›‘æ§å’Œè°ƒè¯•
```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f train.log

# æŸ¥çœ‹GPUä½¿ç”¨
watch -n 1 nvidia-smi

# æ£€æŸ¥checkpoint
ls -lht checkpoints/single_task_scene7/ | head
```

---

## è”ç³»ä¿¡æ¯

- **GitHubä»“åº“**: https://github.com/zxy6677/RoboticsDiffusionTransformer
- **æœåŠ¡å™¨**: pro-20 (172.16.0.27)
- **è·³æ¿æœº**: jump-server-tx (134.175.121.223)

---

**çŠ¶æ€**: âœ… éƒ¨ç½²å®Œæˆï¼Œå‡†å¤‡å¼€å§‹è®­ç»ƒ

**æœ€åæ›´æ–°**: 2024-10-19

